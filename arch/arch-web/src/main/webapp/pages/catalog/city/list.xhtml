<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:o="http://openfaces.org/"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:cst="http://kmware.com/ui">

<ui:composition template="/WEB-INF/templates/default.xhtml">
	<ui:define name="content">
		<h:form id="crudform" prependId="false" acceptcharset="UTF-8">
			<div id="content">

				<o:ajaxSettings onsuccess="console.log('success', arguments)" onsessionexpired="console.log('session expired',arguments)" onerror="console.log('error',arguments)">
					<f:facet name="sessionExpiration">
						<o:defaultSessionExpiration />
					</f:facet>
				</o:ajaxSettings>

				<o:dataTable useAjax="true" sortColumnId="displayName" id="table"
					value="#{cityCRUD.items}" var="item" style="width:100%"
					customDataProviding="true" pageCount="#{cityCRUD.itemsTotalCount}"
					totalRowCount="#{cityCRUD.itemsTotalCount}"
					pageSize="#{cityCRUD.tableState.pageSize}"
					pageIndex="#{cityCRUD.tableState.pageIndex}"
					paginationKeyboardSupport="true">

					<o:column id="displayName" header="Name" styleClass="km-column"
						sortingExpression="#{item.displayName}">
						<o:commandLink value="#{item.displayName}" />
					</o:column>
					<o:column id="zipCode" header="Zip-code" styleClass="km-column">
						<h:outputText value="#{item.zipCode}" />
					</o:column>

					<f:facet name="below">
						<h:panelGroup layout="block" style="height:30px;">
							<h:selectOneMenu id="pageSizeTop"
								value="#{cityCRUD.tableState.pageSize}"
								styleClass="km-paginator-pageSize">
								<f:selectItem itemLabel="5" itemValue="5" />
								<f:selectItem itemLabel="10" itemValue="10" />
								<f:selectItem itemLabel="25" itemValue="25" />
								<f:selectItem itemLabel="50" itemValue="50" />
								<o:ajax event="change" execute="@this" render="table" />
							</h:selectOneMenu>
							<o:dataTablePaginator id="paginatorTop" styleClass="km-paginator"
								showPageCount="true" showIfOnePage="true" />
						</h:panelGroup>
					</f:facet>
				</o:dataTable>
				<script>
				$(document).ready(function() {
					  $(window).keydown(function(event){
					    if( (event.keyCode == 13) ) {
						    if(event.target.className=='o_table_paginator_field'){
						    	event.target.onchange();
							}
					      event.preventDefault();
					      return false;
					    }
					  });
					});
				</script>
			</div>
			<div id="actions" style="padding: 0px 20px;">
				<h:commandButton action="#{navigation.toNew}" value="New record"
					styleClass="button" />

			</div>
		</h:form>
	</ui:define>
</ui:composition>
</html>